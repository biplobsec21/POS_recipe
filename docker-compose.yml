version: '3.8'

services:
  # 1. Web/Application Container (CodeIgniter)
  app:
    build: .
    container_name: ci_app
    ports:
      - "8080:80"  # Map host port 8080 to container port 80
    volumes:
      - .:/var/www/html # Mount your local project code into the container
    depends_on:
      - db # Wait for the database service to start
  
  # 2. Database Container (MySQL)
  db:
    image: mysql:5.7 # Use a stable MySQL version
    container_name: ci_db
    environment:
      # !! CHANGE THESE TO MATCH YOUR EXISTING CI CONFIG !!
      MYSQL_ROOT_PASSWORD: gjoss7SP5d{X_[mL 
      MYSQL_DATABASE: adoralab_21eb_root 
      MYSQL_USER: adoralab_21eb_db
      MYSQL_PASSWORD: gjoss7SP5d{X_[mL
    volumes:
      # This is the key part for your existing database:
      # Copy your local SQL file into the container's init folder
      #/Users/hello/Documents/codeigniter/21eb.ramksofttech.com/adoralab_21eb_root.sql
      - ./adoralab_21eb_root.sql:/docker-entrypoint-initdb.d/init.sql
      # Optional: Volume for persistent data (so data isn't lost on 'down')
      - dbdata:/var/lib/mysql
    ports:
      - "3306:3306" # Expose the database port (optional, but useful for GUI tools)
      # 3. phpMyAdmin Container (New Service) ðŸ†• 
  phpmyadmin:
    image: phpmyadmin/phpmyadmin:latest
    container_name: ci_pma
    # Map host port 8081 to phpMyAdmin's port 80
    ports:
      - "8081:80"
    environment:
      # CRITICAL: This tells phpMyAdmin how to find your database container.
      # The value MUST be the service name of your database container ('db').
      PMA_HOST: db 
      # Optional: Allows logging in with the 'adoralab_21eb_db' user directly
      PMA_USER: adoralab_21eb_db
      PMA_PASSWORD: gjoss7SP5d{X_[mL
    depends_on:
      - db # Ensure the database is running before phpMyAdmin starts
# Docker Volumes for persistent database data
volumes:
  dbdata: